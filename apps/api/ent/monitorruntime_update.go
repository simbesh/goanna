// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"goanna/apps/api/ent/monitor"
	"goanna/apps/api/ent/monitorruntime"
	"goanna/apps/api/ent/predicate"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/schema/field"
)

// MonitorRuntimeUpdate is the builder for updating MonitorRuntime entities.
type MonitorRuntimeUpdate struct {
	config
	hooks    []Hook
	mutation *MonitorRuntimeMutation
}

// Where appends a list predicates to the MonitorRuntimeUpdate builder.
func (_u *MonitorRuntimeUpdate) Where(ps ...predicate.MonitorRuntime) *MonitorRuntimeUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetStatus sets the "status" field.
func (_u *MonitorRuntimeUpdate) SetStatus(v monitorruntime.Status) *MonitorRuntimeUpdate {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableStatus(v *monitorruntime.Status) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// SetCheckCount sets the "check_count" field.
func (_u *MonitorRuntimeUpdate) SetCheckCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetCheckCount()
	_u.mutation.SetCheckCount(v)
	return _u
}

// SetNillableCheckCount sets the "check_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableCheckCount(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetCheckCount(*v)
	}
	return _u
}

// AddCheckCount adds value to the "check_count" field.
func (_u *MonitorRuntimeUpdate) AddCheckCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddCheckCount(v)
	return _u
}

// SetSuccessCount sets the "success_count" field.
func (_u *MonitorRuntimeUpdate) SetSuccessCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetSuccessCount()
	_u.mutation.SetSuccessCount(v)
	return _u
}

// SetNillableSuccessCount sets the "success_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableSuccessCount(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetSuccessCount(*v)
	}
	return _u
}

// AddSuccessCount adds value to the "success_count" field.
func (_u *MonitorRuntimeUpdate) AddSuccessCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddSuccessCount(v)
	return _u
}

// SetErrorCount sets the "error_count" field.
func (_u *MonitorRuntimeUpdate) SetErrorCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetErrorCount()
	_u.mutation.SetErrorCount(v)
	return _u
}

// SetNillableErrorCount sets the "error_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableErrorCount(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetErrorCount(*v)
	}
	return _u
}

// AddErrorCount adds value to the "error_count" field.
func (_u *MonitorRuntimeUpdate) AddErrorCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddErrorCount(v)
	return _u
}

// SetRetryCount sets the "retry_count" field.
func (_u *MonitorRuntimeUpdate) SetRetryCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetRetryCount()
	_u.mutation.SetRetryCount(v)
	return _u
}

// SetNillableRetryCount sets the "retry_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableRetryCount(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetRetryCount(*v)
	}
	return _u
}

// AddRetryCount adds value to the "retry_count" field.
func (_u *MonitorRuntimeUpdate) AddRetryCount(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddRetryCount(v)
	return _u
}

// SetConsecutiveSuccesses sets the "consecutive_successes" field.
func (_u *MonitorRuntimeUpdate) SetConsecutiveSuccesses(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetConsecutiveSuccesses()
	_u.mutation.SetConsecutiveSuccesses(v)
	return _u
}

// SetNillableConsecutiveSuccesses sets the "consecutive_successes" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableConsecutiveSuccesses(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetConsecutiveSuccesses(*v)
	}
	return _u
}

// AddConsecutiveSuccesses adds value to the "consecutive_successes" field.
func (_u *MonitorRuntimeUpdate) AddConsecutiveSuccesses(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddConsecutiveSuccesses(v)
	return _u
}

// SetConsecutiveErrors sets the "consecutive_errors" field.
func (_u *MonitorRuntimeUpdate) SetConsecutiveErrors(v int64) *MonitorRuntimeUpdate {
	_u.mutation.ResetConsecutiveErrors()
	_u.mutation.SetConsecutiveErrors(v)
	return _u
}

// SetNillableConsecutiveErrors sets the "consecutive_errors" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableConsecutiveErrors(v *int64) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetConsecutiveErrors(*v)
	}
	return _u
}

// AddConsecutiveErrors adds value to the "consecutive_errors" field.
func (_u *MonitorRuntimeUpdate) AddConsecutiveErrors(v int64) *MonitorRuntimeUpdate {
	_u.mutation.AddConsecutiveErrors(v)
	return _u
}

// SetLastCheckAt sets the "last_check_at" field.
func (_u *MonitorRuntimeUpdate) SetLastCheckAt(v time.Time) *MonitorRuntimeUpdate {
	_u.mutation.SetLastCheckAt(v)
	return _u
}

// SetNillableLastCheckAt sets the "last_check_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastCheckAt(v *time.Time) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastCheckAt(*v)
	}
	return _u
}

// ClearLastCheckAt clears the value of the "last_check_at" field.
func (_u *MonitorRuntimeUpdate) ClearLastCheckAt() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastCheckAt()
	return _u
}

// SetLastSuccessAt sets the "last_success_at" field.
func (_u *MonitorRuntimeUpdate) SetLastSuccessAt(v time.Time) *MonitorRuntimeUpdate {
	_u.mutation.SetLastSuccessAt(v)
	return _u
}

// SetNillableLastSuccessAt sets the "last_success_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastSuccessAt(v *time.Time) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastSuccessAt(*v)
	}
	return _u
}

// ClearLastSuccessAt clears the value of the "last_success_at" field.
func (_u *MonitorRuntimeUpdate) ClearLastSuccessAt() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastSuccessAt()
	return _u
}

// SetLastErrorAt sets the "last_error_at" field.
func (_u *MonitorRuntimeUpdate) SetLastErrorAt(v time.Time) *MonitorRuntimeUpdate {
	_u.mutation.SetLastErrorAt(v)
	return _u
}

// SetNillableLastErrorAt sets the "last_error_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastErrorAt(v *time.Time) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastErrorAt(*v)
	}
	return _u
}

// ClearLastErrorAt clears the value of the "last_error_at" field.
func (_u *MonitorRuntimeUpdate) ClearLastErrorAt() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastErrorAt()
	return _u
}

// SetLastStatusCode sets the "last_status_code" field.
func (_u *MonitorRuntimeUpdate) SetLastStatusCode(v int) *MonitorRuntimeUpdate {
	_u.mutation.ResetLastStatusCode()
	_u.mutation.SetLastStatusCode(v)
	return _u
}

// SetNillableLastStatusCode sets the "last_status_code" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastStatusCode(v *int) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastStatusCode(*v)
	}
	return _u
}

// AddLastStatusCode adds value to the "last_status_code" field.
func (_u *MonitorRuntimeUpdate) AddLastStatusCode(v int) *MonitorRuntimeUpdate {
	_u.mutation.AddLastStatusCode(v)
	return _u
}

// ClearLastStatusCode clears the value of the "last_status_code" field.
func (_u *MonitorRuntimeUpdate) ClearLastStatusCode() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastStatusCode()
	return _u
}

// SetLastDurationMs sets the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdate) SetLastDurationMs(v int) *MonitorRuntimeUpdate {
	_u.mutation.ResetLastDurationMs()
	_u.mutation.SetLastDurationMs(v)
	return _u
}

// SetNillableLastDurationMs sets the "last_duration_ms" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastDurationMs(v *int) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastDurationMs(*v)
	}
	return _u
}

// AddLastDurationMs adds value to the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdate) AddLastDurationMs(v int) *MonitorRuntimeUpdate {
	_u.mutation.AddLastDurationMs(v)
	return _u
}

// ClearLastDurationMs clears the value of the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdate) ClearLastDurationMs() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastDurationMs()
	return _u
}

// SetLastErrorMessage sets the "last_error_message" field.
func (_u *MonitorRuntimeUpdate) SetLastErrorMessage(v string) *MonitorRuntimeUpdate {
	_u.mutation.SetLastErrorMessage(v)
	return _u
}

// SetNillableLastErrorMessage sets the "last_error_message" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableLastErrorMessage(v *string) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetLastErrorMessage(*v)
	}
	return _u
}

// ClearLastErrorMessage clears the value of the "last_error_message" field.
func (_u *MonitorRuntimeUpdate) ClearLastErrorMessage() *MonitorRuntimeUpdate {
	_u.mutation.ClearLastErrorMessage()
	return _u
}

// SetNextRunAt sets the "next_run_at" field.
func (_u *MonitorRuntimeUpdate) SetNextRunAt(v time.Time) *MonitorRuntimeUpdate {
	_u.mutation.SetNextRunAt(v)
	return _u
}

// SetNillableNextRunAt sets the "next_run_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdate) SetNillableNextRunAt(v *time.Time) *MonitorRuntimeUpdate {
	if v != nil {
		_u.SetNextRunAt(*v)
	}
	return _u
}

// ClearNextRunAt clears the value of the "next_run_at" field.
func (_u *MonitorRuntimeUpdate) ClearNextRunAt() *MonitorRuntimeUpdate {
	_u.mutation.ClearNextRunAt()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *MonitorRuntimeUpdate) SetUpdatedAt(v time.Time) *MonitorRuntimeUpdate {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// SetMonitorID sets the "monitor" edge to the Monitor entity by ID.
func (_u *MonitorRuntimeUpdate) SetMonitorID(id int) *MonitorRuntimeUpdate {
	_u.mutation.SetMonitorID(id)
	return _u
}

// SetMonitor sets the "monitor" edge to the Monitor entity.
func (_u *MonitorRuntimeUpdate) SetMonitor(v *Monitor) *MonitorRuntimeUpdate {
	return _u.SetMonitorID(v.ID)
}

// Mutation returns the MonitorRuntimeMutation object of the builder.
func (_u *MonitorRuntimeUpdate) Mutation() *MonitorRuntimeMutation {
	return _u.mutation
}

// ClearMonitor clears the "monitor" edge to the Monitor entity.
func (_u *MonitorRuntimeUpdate) ClearMonitor() *MonitorRuntimeUpdate {
	_u.mutation.ClearMonitor()
	return _u
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *MonitorRuntimeUpdate) Save(ctx context.Context) (int, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *MonitorRuntimeUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *MonitorRuntimeUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *MonitorRuntimeUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *MonitorRuntimeUpdate) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok {
		v := monitorruntime.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *MonitorRuntimeUpdate) check() error {
	if v, ok := _u.mutation.Status(); ok {
		if err := monitorruntime.StatusValidator(v); err != nil {
			return &ValidationError{Name: "status", err: fmt.Errorf(`ent: validator failed for field "MonitorRuntime.status": %w`, err)}
		}
	}
	if _u.mutation.MonitorCleared() && len(_u.mutation.MonitorIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "MonitorRuntime.monitor"`)
	}
	return nil
}

func (_u *MonitorRuntimeUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(monitorruntime.Table, monitorruntime.Columns, sqlgraph.NewFieldSpec(monitorruntime.FieldID, field.TypeInt))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(monitorruntime.FieldStatus, field.TypeEnum, value)
	}
	if value, ok := _u.mutation.CheckCount(); ok {
		_spec.SetField(monitorruntime.FieldCheckCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedCheckCount(); ok {
		_spec.AddField(monitorruntime.FieldCheckCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.SuccessCount(); ok {
		_spec.SetField(monitorruntime.FieldSuccessCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedSuccessCount(); ok {
		_spec.AddField(monitorruntime.FieldSuccessCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ErrorCount(); ok {
		_spec.SetField(monitorruntime.FieldErrorCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedErrorCount(); ok {
		_spec.AddField(monitorruntime.FieldErrorCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.RetryCount(); ok {
		_spec.SetField(monitorruntime.FieldRetryCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedRetryCount(); ok {
		_spec.AddField(monitorruntime.FieldRetryCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ConsecutiveSuccesses(); ok {
		_spec.SetField(monitorruntime.FieldConsecutiveSuccesses, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedConsecutiveSuccesses(); ok {
		_spec.AddField(monitorruntime.FieldConsecutiveSuccesses, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ConsecutiveErrors(); ok {
		_spec.SetField(monitorruntime.FieldConsecutiveErrors, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedConsecutiveErrors(); ok {
		_spec.AddField(monitorruntime.FieldConsecutiveErrors, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.LastCheckAt(); ok {
		_spec.SetField(monitorruntime.FieldLastCheckAt, field.TypeTime, value)
	}
	if _u.mutation.LastCheckAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastCheckAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastSuccessAt(); ok {
		_spec.SetField(monitorruntime.FieldLastSuccessAt, field.TypeTime, value)
	}
	if _u.mutation.LastSuccessAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastSuccessAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastErrorAt(); ok {
		_spec.SetField(monitorruntime.FieldLastErrorAt, field.TypeTime, value)
	}
	if _u.mutation.LastErrorAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastErrorAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastStatusCode(); ok {
		_spec.SetField(monitorruntime.FieldLastStatusCode, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedLastStatusCode(); ok {
		_spec.AddField(monitorruntime.FieldLastStatusCode, field.TypeInt, value)
	}
	if _u.mutation.LastStatusCodeCleared() {
		_spec.ClearField(monitorruntime.FieldLastStatusCode, field.TypeInt)
	}
	if value, ok := _u.mutation.LastDurationMs(); ok {
		_spec.SetField(monitorruntime.FieldLastDurationMs, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedLastDurationMs(); ok {
		_spec.AddField(monitorruntime.FieldLastDurationMs, field.TypeInt, value)
	}
	if _u.mutation.LastDurationMsCleared() {
		_spec.ClearField(monitorruntime.FieldLastDurationMs, field.TypeInt)
	}
	if value, ok := _u.mutation.LastErrorMessage(); ok {
		_spec.SetField(monitorruntime.FieldLastErrorMessage, field.TypeString, value)
	}
	if _u.mutation.LastErrorMessageCleared() {
		_spec.ClearField(monitorruntime.FieldLastErrorMessage, field.TypeString)
	}
	if value, ok := _u.mutation.NextRunAt(); ok {
		_spec.SetField(monitorruntime.FieldNextRunAt, field.TypeTime, value)
	}
	if _u.mutation.NextRunAtCleared() {
		_spec.ClearField(monitorruntime.FieldNextRunAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(monitorruntime.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.MonitorCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2O,
			Inverse: true,
			Table:   monitorruntime.MonitorTable,
			Columns: []string{monitorruntime.MonitorColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(monitor.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := _u.mutation.MonitorIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2O,
			Inverse: true,
			Table:   monitorruntime.MonitorTable,
			Columns: []string{monitorruntime.MonitorColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(monitor.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{monitorruntime.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// MonitorRuntimeUpdateOne is the builder for updating a single MonitorRuntime entity.
type MonitorRuntimeUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *MonitorRuntimeMutation
}

// SetStatus sets the "status" field.
func (_u *MonitorRuntimeUpdateOne) SetStatus(v monitorruntime.Status) *MonitorRuntimeUpdateOne {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableStatus(v *monitorruntime.Status) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// SetCheckCount sets the "check_count" field.
func (_u *MonitorRuntimeUpdateOne) SetCheckCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetCheckCount()
	_u.mutation.SetCheckCount(v)
	return _u
}

// SetNillableCheckCount sets the "check_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableCheckCount(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetCheckCount(*v)
	}
	return _u
}

// AddCheckCount adds value to the "check_count" field.
func (_u *MonitorRuntimeUpdateOne) AddCheckCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddCheckCount(v)
	return _u
}

// SetSuccessCount sets the "success_count" field.
func (_u *MonitorRuntimeUpdateOne) SetSuccessCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetSuccessCount()
	_u.mutation.SetSuccessCount(v)
	return _u
}

// SetNillableSuccessCount sets the "success_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableSuccessCount(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetSuccessCount(*v)
	}
	return _u
}

// AddSuccessCount adds value to the "success_count" field.
func (_u *MonitorRuntimeUpdateOne) AddSuccessCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddSuccessCount(v)
	return _u
}

// SetErrorCount sets the "error_count" field.
func (_u *MonitorRuntimeUpdateOne) SetErrorCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetErrorCount()
	_u.mutation.SetErrorCount(v)
	return _u
}

// SetNillableErrorCount sets the "error_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableErrorCount(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetErrorCount(*v)
	}
	return _u
}

// AddErrorCount adds value to the "error_count" field.
func (_u *MonitorRuntimeUpdateOne) AddErrorCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddErrorCount(v)
	return _u
}

// SetRetryCount sets the "retry_count" field.
func (_u *MonitorRuntimeUpdateOne) SetRetryCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetRetryCount()
	_u.mutation.SetRetryCount(v)
	return _u
}

// SetNillableRetryCount sets the "retry_count" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableRetryCount(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetRetryCount(*v)
	}
	return _u
}

// AddRetryCount adds value to the "retry_count" field.
func (_u *MonitorRuntimeUpdateOne) AddRetryCount(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddRetryCount(v)
	return _u
}

// SetConsecutiveSuccesses sets the "consecutive_successes" field.
func (_u *MonitorRuntimeUpdateOne) SetConsecutiveSuccesses(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetConsecutiveSuccesses()
	_u.mutation.SetConsecutiveSuccesses(v)
	return _u
}

// SetNillableConsecutiveSuccesses sets the "consecutive_successes" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableConsecutiveSuccesses(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetConsecutiveSuccesses(*v)
	}
	return _u
}

// AddConsecutiveSuccesses adds value to the "consecutive_successes" field.
func (_u *MonitorRuntimeUpdateOne) AddConsecutiveSuccesses(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddConsecutiveSuccesses(v)
	return _u
}

// SetConsecutiveErrors sets the "consecutive_errors" field.
func (_u *MonitorRuntimeUpdateOne) SetConsecutiveErrors(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetConsecutiveErrors()
	_u.mutation.SetConsecutiveErrors(v)
	return _u
}

// SetNillableConsecutiveErrors sets the "consecutive_errors" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableConsecutiveErrors(v *int64) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetConsecutiveErrors(*v)
	}
	return _u
}

// AddConsecutiveErrors adds value to the "consecutive_errors" field.
func (_u *MonitorRuntimeUpdateOne) AddConsecutiveErrors(v int64) *MonitorRuntimeUpdateOne {
	_u.mutation.AddConsecutiveErrors(v)
	return _u
}

// SetLastCheckAt sets the "last_check_at" field.
func (_u *MonitorRuntimeUpdateOne) SetLastCheckAt(v time.Time) *MonitorRuntimeUpdateOne {
	_u.mutation.SetLastCheckAt(v)
	return _u
}

// SetNillableLastCheckAt sets the "last_check_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastCheckAt(v *time.Time) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastCheckAt(*v)
	}
	return _u
}

// ClearLastCheckAt clears the value of the "last_check_at" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastCheckAt() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastCheckAt()
	return _u
}

// SetLastSuccessAt sets the "last_success_at" field.
func (_u *MonitorRuntimeUpdateOne) SetLastSuccessAt(v time.Time) *MonitorRuntimeUpdateOne {
	_u.mutation.SetLastSuccessAt(v)
	return _u
}

// SetNillableLastSuccessAt sets the "last_success_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastSuccessAt(v *time.Time) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastSuccessAt(*v)
	}
	return _u
}

// ClearLastSuccessAt clears the value of the "last_success_at" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastSuccessAt() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastSuccessAt()
	return _u
}

// SetLastErrorAt sets the "last_error_at" field.
func (_u *MonitorRuntimeUpdateOne) SetLastErrorAt(v time.Time) *MonitorRuntimeUpdateOne {
	_u.mutation.SetLastErrorAt(v)
	return _u
}

// SetNillableLastErrorAt sets the "last_error_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastErrorAt(v *time.Time) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastErrorAt(*v)
	}
	return _u
}

// ClearLastErrorAt clears the value of the "last_error_at" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastErrorAt() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastErrorAt()
	return _u
}

// SetLastStatusCode sets the "last_status_code" field.
func (_u *MonitorRuntimeUpdateOne) SetLastStatusCode(v int) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetLastStatusCode()
	_u.mutation.SetLastStatusCode(v)
	return _u
}

// SetNillableLastStatusCode sets the "last_status_code" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastStatusCode(v *int) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastStatusCode(*v)
	}
	return _u
}

// AddLastStatusCode adds value to the "last_status_code" field.
func (_u *MonitorRuntimeUpdateOne) AddLastStatusCode(v int) *MonitorRuntimeUpdateOne {
	_u.mutation.AddLastStatusCode(v)
	return _u
}

// ClearLastStatusCode clears the value of the "last_status_code" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastStatusCode() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastStatusCode()
	return _u
}

// SetLastDurationMs sets the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdateOne) SetLastDurationMs(v int) *MonitorRuntimeUpdateOne {
	_u.mutation.ResetLastDurationMs()
	_u.mutation.SetLastDurationMs(v)
	return _u
}

// SetNillableLastDurationMs sets the "last_duration_ms" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastDurationMs(v *int) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastDurationMs(*v)
	}
	return _u
}

// AddLastDurationMs adds value to the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdateOne) AddLastDurationMs(v int) *MonitorRuntimeUpdateOne {
	_u.mutation.AddLastDurationMs(v)
	return _u
}

// ClearLastDurationMs clears the value of the "last_duration_ms" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastDurationMs() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastDurationMs()
	return _u
}

// SetLastErrorMessage sets the "last_error_message" field.
func (_u *MonitorRuntimeUpdateOne) SetLastErrorMessage(v string) *MonitorRuntimeUpdateOne {
	_u.mutation.SetLastErrorMessage(v)
	return _u
}

// SetNillableLastErrorMessage sets the "last_error_message" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableLastErrorMessage(v *string) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetLastErrorMessage(*v)
	}
	return _u
}

// ClearLastErrorMessage clears the value of the "last_error_message" field.
func (_u *MonitorRuntimeUpdateOne) ClearLastErrorMessage() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearLastErrorMessage()
	return _u
}

// SetNextRunAt sets the "next_run_at" field.
func (_u *MonitorRuntimeUpdateOne) SetNextRunAt(v time.Time) *MonitorRuntimeUpdateOne {
	_u.mutation.SetNextRunAt(v)
	return _u
}

// SetNillableNextRunAt sets the "next_run_at" field if the given value is not nil.
func (_u *MonitorRuntimeUpdateOne) SetNillableNextRunAt(v *time.Time) *MonitorRuntimeUpdateOne {
	if v != nil {
		_u.SetNextRunAt(*v)
	}
	return _u
}

// ClearNextRunAt clears the value of the "next_run_at" field.
func (_u *MonitorRuntimeUpdateOne) ClearNextRunAt() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearNextRunAt()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *MonitorRuntimeUpdateOne) SetUpdatedAt(v time.Time) *MonitorRuntimeUpdateOne {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// SetMonitorID sets the "monitor" edge to the Monitor entity by ID.
func (_u *MonitorRuntimeUpdateOne) SetMonitorID(id int) *MonitorRuntimeUpdateOne {
	_u.mutation.SetMonitorID(id)
	return _u
}

// SetMonitor sets the "monitor" edge to the Monitor entity.
func (_u *MonitorRuntimeUpdateOne) SetMonitor(v *Monitor) *MonitorRuntimeUpdateOne {
	return _u.SetMonitorID(v.ID)
}

// Mutation returns the MonitorRuntimeMutation object of the builder.
func (_u *MonitorRuntimeUpdateOne) Mutation() *MonitorRuntimeMutation {
	return _u.mutation
}

// ClearMonitor clears the "monitor" edge to the Monitor entity.
func (_u *MonitorRuntimeUpdateOne) ClearMonitor() *MonitorRuntimeUpdateOne {
	_u.mutation.ClearMonitor()
	return _u
}

// Where appends a list predicates to the MonitorRuntimeUpdate builder.
func (_u *MonitorRuntimeUpdateOne) Where(ps ...predicate.MonitorRuntime) *MonitorRuntimeUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *MonitorRuntimeUpdateOne) Select(field string, fields ...string) *MonitorRuntimeUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated MonitorRuntime entity.
func (_u *MonitorRuntimeUpdateOne) Save(ctx context.Context) (*MonitorRuntime, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *MonitorRuntimeUpdateOne) SaveX(ctx context.Context) *MonitorRuntime {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *MonitorRuntimeUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *MonitorRuntimeUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *MonitorRuntimeUpdateOne) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok {
		v := monitorruntime.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *MonitorRuntimeUpdateOne) check() error {
	if v, ok := _u.mutation.Status(); ok {
		if err := monitorruntime.StatusValidator(v); err != nil {
			return &ValidationError{Name: "status", err: fmt.Errorf(`ent: validator failed for field "MonitorRuntime.status": %w`, err)}
		}
	}
	if _u.mutation.MonitorCleared() && len(_u.mutation.MonitorIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "MonitorRuntime.monitor"`)
	}
	return nil
}

func (_u *MonitorRuntimeUpdateOne) sqlSave(ctx context.Context) (_node *MonitorRuntime, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(monitorruntime.Table, monitorruntime.Columns, sqlgraph.NewFieldSpec(monitorruntime.FieldID, field.TypeInt))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "MonitorRuntime.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, monitorruntime.FieldID)
		for _, f := range fields {
			if !monitorruntime.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != monitorruntime.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(monitorruntime.FieldStatus, field.TypeEnum, value)
	}
	if value, ok := _u.mutation.CheckCount(); ok {
		_spec.SetField(monitorruntime.FieldCheckCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedCheckCount(); ok {
		_spec.AddField(monitorruntime.FieldCheckCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.SuccessCount(); ok {
		_spec.SetField(monitorruntime.FieldSuccessCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedSuccessCount(); ok {
		_spec.AddField(monitorruntime.FieldSuccessCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ErrorCount(); ok {
		_spec.SetField(monitorruntime.FieldErrorCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedErrorCount(); ok {
		_spec.AddField(monitorruntime.FieldErrorCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.RetryCount(); ok {
		_spec.SetField(monitorruntime.FieldRetryCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedRetryCount(); ok {
		_spec.AddField(monitorruntime.FieldRetryCount, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ConsecutiveSuccesses(); ok {
		_spec.SetField(monitorruntime.FieldConsecutiveSuccesses, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedConsecutiveSuccesses(); ok {
		_spec.AddField(monitorruntime.FieldConsecutiveSuccesses, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.ConsecutiveErrors(); ok {
		_spec.SetField(monitorruntime.FieldConsecutiveErrors, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.AddedConsecutiveErrors(); ok {
		_spec.AddField(monitorruntime.FieldConsecutiveErrors, field.TypeInt64, value)
	}
	if value, ok := _u.mutation.LastCheckAt(); ok {
		_spec.SetField(monitorruntime.FieldLastCheckAt, field.TypeTime, value)
	}
	if _u.mutation.LastCheckAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastCheckAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastSuccessAt(); ok {
		_spec.SetField(monitorruntime.FieldLastSuccessAt, field.TypeTime, value)
	}
	if _u.mutation.LastSuccessAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastSuccessAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastErrorAt(); ok {
		_spec.SetField(monitorruntime.FieldLastErrorAt, field.TypeTime, value)
	}
	if _u.mutation.LastErrorAtCleared() {
		_spec.ClearField(monitorruntime.FieldLastErrorAt, field.TypeTime)
	}
	if value, ok := _u.mutation.LastStatusCode(); ok {
		_spec.SetField(monitorruntime.FieldLastStatusCode, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedLastStatusCode(); ok {
		_spec.AddField(monitorruntime.FieldLastStatusCode, field.TypeInt, value)
	}
	if _u.mutation.LastStatusCodeCleared() {
		_spec.ClearField(monitorruntime.FieldLastStatusCode, field.TypeInt)
	}
	if value, ok := _u.mutation.LastDurationMs(); ok {
		_spec.SetField(monitorruntime.FieldLastDurationMs, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedLastDurationMs(); ok {
		_spec.AddField(monitorruntime.FieldLastDurationMs, field.TypeInt, value)
	}
	if _u.mutation.LastDurationMsCleared() {
		_spec.ClearField(monitorruntime.FieldLastDurationMs, field.TypeInt)
	}
	if value, ok := _u.mutation.LastErrorMessage(); ok {
		_spec.SetField(monitorruntime.FieldLastErrorMessage, field.TypeString, value)
	}
	if _u.mutation.LastErrorMessageCleared() {
		_spec.ClearField(monitorruntime.FieldLastErrorMessage, field.TypeString)
	}
	if value, ok := _u.mutation.NextRunAt(); ok {
		_spec.SetField(monitorruntime.FieldNextRunAt, field.TypeTime, value)
	}
	if _u.mutation.NextRunAtCleared() {
		_spec.ClearField(monitorruntime.FieldNextRunAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(monitorruntime.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.MonitorCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2O,
			Inverse: true,
			Table:   monitorruntime.MonitorTable,
			Columns: []string{monitorruntime.MonitorColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(monitor.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := _u.mutation.MonitorIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2O,
			Inverse: true,
			Table:   monitorruntime.MonitorTable,
			Columns: []string{monitorruntime.MonitorColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(monitor.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_node = &MonitorRuntime{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{monitorruntime.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
